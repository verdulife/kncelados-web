---
import { seasons, getCurrentEpisode } from "@/lib/utils";

import Layout from "@/layouts/Layout.astro";
import VideoHeader from "@/components/VideoHeader.astro";
import VideoSlider from "@/components/VideoSlider.astro";

const { slug } = Astro.params;
if (!slug) return;

const current_episode = getCurrentEpisode(slug);
const collections_data = await Astro.glob("@/lib/collections/*.json");
const collections = collections_data
  .map((collection) => collection.default)
  .reverse();
---

<Layout
  title={current_episode && current_episode.title}
  description={current_episode && current_episode.description}
  image={current_episode && current_episode.image}
>
  <div class="bg-black text-gray-50">
    <div class="bg-knc-blue/40 pb-10">
      <VideoHeader data={current_episode} />

      {seasons.map((season) => <VideoSlider data={season} />)}

      <VideoSlider data={collections} title="Recopilaciones" />
    </div>
  </div>
</Layout>
