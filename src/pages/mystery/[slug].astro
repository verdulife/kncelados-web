---
import "@fontsource-variable/inter";
import Layout from "@/layouts/Layout.astro";
import { videos } from "@/lib/mystery";

const { slug } = Astro.params;
const video = videos.find((v) => v.slug === slug);

if (!video) return Astro.redirect("/");

const { title, videoUrl } = video;
---

<Layout title={title}>
  <section
    class="flex flex-1 flex-col items-center justify-center gap-4 p-8 text-center"
  >
    <p class="text-knc-red text-lg">
      Redirigiendo en <span id="redirect-counter" class="text-neutral-50">3</span> a la solución de
    </p>

    <h1 class="text-2xl">
      {title}
    </h1>

    <hr class="my-8 w-1/3 border-neutral-500" />

    <p>
      Si tras 5 segundos no eres redirigido a la solución, accede con el
      siguiente enlace
    </p>
    <a
      href={videoUrl}
      class="bg-knc-red rounded-xl px-8 py-3 transition-transform hover:scale-110"
    >
      Ir a la solución
    </a>
  </section>
</Layout>

<style>
  p {
    font-family:
      "Inter Variable",
      system-ui,
      -apple-system,
      BlinkMacSystemFont,
      "Segoe UI",
      Roboto,
      Oxygen,
      Ubuntu,
      Cantarell,
      "Open Sans",
      "Helvetica Neue",
      sans-serif;
  }
</style>

<script define:vars={{ videoUrl }} is:inline>
  const redirectCounter = document.querySelector("#redirect-counter");

  const interval = setInterval(() => {
    redirectCounter.innerText = Number(redirectCounter.innerText) - 1;

    if (redirectCounter.innerText === 0) {
      clearInterval(interval);
    }
  }, 1000);

  setTimeout(() => (window.location.href = videoUrl), 3000);
</script>
