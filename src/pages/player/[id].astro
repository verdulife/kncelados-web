---
import Layout from "@/layouts/Layout.astro";
import Close from "@/lib/assets/Close.astro";
const { id } = Astro.params;
---

<Layout>
  <main class="fixed inset-0 z-50 h-screen bg-black">
    {
      id && (
        <iframe
          width="100%"
          height="100%"
          src={`https://www.youtube.com/embed/${id}?autoplay=1`}
          allow="autoplay; encrypted-media; picture-in-picture; web-share"
          referrerpolicy="strict-origin-when-cross-origin"
          allowfullscreen
        />
      )
    }

    <div
      class="pointer-events-none absolute top-0 flex w-full justify-center p-4"
    >
      <button
        id="close-btn"
        class="pointer-events-auto rounded-full bg-black/40 p-4 text-xl text-gray-50 backdrop-blur transition-transform hover:scale-110"
      >
        <Close class="size-6" />
      </button>
    </div>
  </main>
</Layout>

<script>
  function init_player() {
    const closeBtn = document.querySelector("#close-btn");
    if (!closeBtn) return;

    closeBtn.addEventListener("click", () => history.back());
  }

  init_player();
  document.addEventListener("astro:after-swap", init_player);
</script>
